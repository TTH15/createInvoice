/* ==============================================
   カラーパレット・基本変数
   ============================================== */

:root {
    --ink: #111;               /* メインテキスト色 */
    --muted: #666;             /* サブテキスト色 */
    --border: #ddd;            /* 境界線色 */
    --accent: #111;            /* アクセント色 */
    --light-gray: #f8f8f8;     /* 薄いグレー背景 */
}

/* ==============================================
   全体の基本スタイル
   ============================================== */

/* ボックスサイズ設定 */
* {
    box-sizing: border-box;
}

/* ページ全体のスタイル */
body {
    margin: 0;
    font-family: "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Segoe UI", system-ui, -apple-system, sans-serif;
    color: var(--ink);         /* メインテキスト色 */
    background: #f6f6f6;       /* ページ背景色 */
}

/* ==============================================
   メインレイアウト（編集画面+プレビュー画面）
   ============================================== */

/* 全体のコンテナ */
.wrap {
    display: flex;
    flex-direction: column;
    padding: 20px;             /* 画面全体の余白 */
}

/* コントロールバー */
.control-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #fff;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 16px 20px;
    margin-bottom: 20px;
    box-shadow: 0 1px 3px rgba(0,0,0,.08);
}

.control-left {
    display: flex;
    align-items: center;
    gap: 16px;
}

.control-right {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* パネル（編集画面・プレビュー画面共通） */
.panel {
    background: #fff;          /* パネル背景色 */
    border: 1px solid var(--border);
    border-radius: 8px;        /* パネルの角の丸み */
    box-shadow: 0 1px 3px rgba(0,0,0,.08);  /* パネルの影 */
}

/* ==============================================
   編集画面（左側）のスタイル
   ============================================== */

/* 編集フォームエリア */
.form {
    width: 420px;              /* 編集画面の幅 */
    padding: 20px;             /* 編集画面内の余白 */
}

/* 編集画面の見出し */
.form h2 {
    font-size: 16px;           /* 見出しサイズ */
    margin: 8px 0 12px 0;      /* 見出しの余白 */
}

/* ==============================================
   フォーム要素のスタイル
   ============================================== */

/* 横並びレイアウト用 */
.row {
    display: flex;
    gap: 10px;                 /* 要素間の間隔 */
}

/* ラベル（項目名） */
label {
    display: block;
    font-size: 12px;           /* ラベル文字サイズ */
    color: var(--muted);       /* ラベル文字色 */
    margin: 10px 0 6px;        /* ラベルの余白 */
}

/* 入力フィールド（テキスト・セレクト・テキストエリア） */
input, select, textarea {
    width: 100%;
    padding: 10px 12px;        /* 入力欄内の余白 */
    border: 1px solid var(--border);
    border-radius: 6px;        /* 入力欄の角の丸み */
    background: #fff;
    font-size: 14px;           /* 入力文字サイズ */
}

/* テキストエリア専用設定 */
textarea {
    min-height: 64px;          /* テキストエリアの最小高さ */
    resize: vertical;          /* 縦方向のみリサイズ可能 */
}

/* ==============================================
   ボタンのスタイル
   ============================================== */

/* 基本ボタン */
.btn {
    display: inline-flex;
    align-items: center;
    gap: .5em;                 /* ボタン内要素の間隔 */
    padding: 10px 14px;        /* ボタン内余白 */
    border-radius: 6px;        /* ボタンの角の丸み */
    border: 1px solid var(--border);
    background: #fff;          /* ボタン背景色 */
    cursor: pointer;
}

/* プライマリボタン（重要なアクション） */
.btn.primary {
    background: var(--accent); /* アクセント背景色 */
    color: #fff;               /* 白文字 */
    border-color: var(--accent);
}

/* ゴーストボタン（控えめなアクション） */
.btn.ghost {
    background: #fff;          /* 白背景 */
}

/* 小さいボタン */
.btn.small {
    padding: 6px 10px;         /* 小さいボタンの余白 */
    font-size: 12px;           /* 小さいボタンの文字サイズ */
}

/* ==============================================
   レイアウト・ユーティリティクラス
   ============================================== */

/* セクション区切り */
.section {
    padding: 12px 0;           /* セクション上下の余白 */
    border-top: 1px solid #eee; /* セクション区切り線 */
    margin-top: 16px;          /* セクション上マージン */
}

/* 左右に要素を配置 */
.flex-between {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* サブテキスト色 */
.muted {
    color: var(--muted);
}

/* 等幅フォント */
.code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
}
/* ==============================================
   プレビュー画面全体のレイアウト設定
   ============================================== */

/* プレビューエリア全体のコンテナ */
.preview-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* A4サイズのプレビューパネル */
.preview {
    width: 210mm;        /* A4幅 */
    height: 297mm;       /* A4高さ */
    background: #fff;
    border: 1px solid var(--border);
    border-radius: 8px;
    margin: auto;
    overflow: hidden;
    position: relative;
}

/* 実際の請求書シート（余白設定） */
.sheet {
    padding: 18mm 16mm 16mm 16mm;  /* 上右下左の余白 */
}

/* ==============================================
   請求書タイトル部分
   ============================================== */

/* 「御 請 求 書」のタイトル */
.title {
    font-weight: 700;
    letter-spacing: .4em;    /* 文字間隔 */
    border-bottom: 2px solid #111;
    font-size: 24px;         /* タイトルサイズ */
    padding-bottom: 8px;
    margin-bottom: 24px;
    text-align: center;
}

/* ==============================================
   宛先・自社情報エリア（上部の2つのボックス）
   ============================================== */

/* 左右に分かれたメタ情報コンテナ */
.meta {
    display: flex;
    justify-content: space-between;
    gap: 20px;               /* 左右のボックス間の間隔 */
    margin-bottom: 20px;
    align-items: stretch;    /* 左右のボックスの高さを揃える */
}

/* 各ボックス（左：宛先、右：自社情報） */
.meta .box {
    flex: 1;
}

/* 右側のボックス（自社情報）の幅を固定 */
.meta .box:last-child {
    flex: 0 0 auto;
    min-width: 250px;        /* 右側ボックスの最小幅 */
}

/* 基本的なキー・バリュー表示スタイル */
.kv {
    font-size: 13px;         /* 文字サイズ */
    line-height: 1.6;        /* 行間 */
}

.kv div {
    margin-bottom: 2px;      /* 各行の下マージン */
    display: block;          /* 縦並び表示を確実にする */
    width: 100%;             /* 幅を100%にして横並びを防ぐ */
}

.kv b {
    min-width: 80px;         /* ラベル部分の最小幅 */
    display: inline-block;
}

/* 右寄せ表示用のスタイル（差出人エリアでは左寄せをオーバーライド） */
.kv.right {
    text-align: right;
}

.kv.right div {
    text-align: right;
}

.kv.right b {
    margin-right: 8px;
}

/* 右側ボックス全体を左寄せに変更 */
.meta .box:last-child .kv {
    text-align: left;
}

.meta .box:last-child .kv div {
    text-align: left;
    display: block;          /* 縦並び表示を確実にする */
    width: 100%;             /* 幅を100%にして横並びを防ぐ */
    float: none;             /* フロートを無効化 */
    clear: both;             /* フロートをクリア */
}

/* 請求日・請求書番号エリアのスタイル調整 */
.meta .box:last-child .kv.right {
    text-align: left; /* 全体は左寄せ */
}

.meta .box:last-child .kv.right div {
    text-align: left; /* div全体は左寄せ */
    display: flex; /* flexboxで配置 */
    justify-content: space-between; /* 左右に分ける */
    align-items: baseline; /* ベースライン揃え */
}

.meta .box:last-child .kv.right b {
    margin-right: 8px;
    flex-shrink: 0; /* ラベル部分の幅を固定 */
}

.meta .box:last-child .kv.right span {
    text-align: right; /* 数字部分は右寄せ */
    margin-left: auto; /* 右端に配置 */
}

/* 宛先ボックス（左側）のスタイル */
.to-box {
    padding: 12px;           /* ボックス内の余白 */
    display: flex;
    flex-direction: column;
    height: 100%;            /* 高さを最大に */
}

/* 挨拶文セクションを下に配置 */
.greeting-section {
    margin-top: 45px;  /* 上マージンを自動で最大に */
    padding-bottom: 6px;          /* 下部にパディング */
}

.greeting-section #p_subject {
    margin-top: 4px;
}

.to-name {
    font-size: 18px;
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    width: 100%;
    border-bottom: 1px solid #000;
    font-weight: 600;
}

/* ==============================================
   ご請求金額エリア
   ============================================== */

/* 請求金額の見出し行 */
.headline {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 20px 0 16px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 8px;
    width: 60%;
    margin-right: 40%;
}

/* 「ご請求金額」ラベル */
.headline .muted {
    font-size: 14px;
    font-weight: 600;
}

/* 実際の請求金額 */
.headline .sum {
    font-size: 20px;         /* 金額の文字サイズ */
    font-weight: 700;
    text-align: right;
}

/* ==============================================
   明細テーブル関連（画像デザイン完全再現）
   ============================================== */

/* テーブル全体のスタイル */
.tbl {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;         /* テーブル内文字サイズ */
    margin-top: 0px;
    margin-bottom: 16px;
    position: relative;      /* 追加ボタンの基準となる位置 */
    border: none;            /* 外枠は削除 */
}

/* テーブルヘッダーのスタイル */
.tbl thead th {
    background: #000;        /* 黒背景 */
    color: #fff;             /* 白文字 */
    font-weight: 600;
    text-align: center;      /* 中央揃え */
    padding: 10px 12px;      /* 上下の余白を少し増やす */
    border: none;            /* ボーダーなし */
    height: 28px;
}

/* テーブル本体のセルスタイル */
.tbl tbody td {
    border: none;            /* ボーダーなし */
    border-bottom: 1px solid #000;  /* 下線のみ */
    padding: 6px 10px;       /* セル内余白 */
    text-align: left;
    background: #fff;        /* 白背景 */
}

/* 右寄せセル */
.tbl tbody td.right {
    text-align: right;
}

/* セクションヘッダー行 */
.section-row {
    border: none;
}

/* セクション名セル（摘要欄に表示） */
.section-name-cell .inner {
    border: none !important;
    padding: 6px 10px !important;
    text-align: center;      /* 中央揃え */
    vertical-align: middle;  /* 垂直方向の中央揃え */
    font-weight: bold;       /* 太字 */
    color: #000;             /* 黒文字 */
    background: #fff;        /* 白背景 */
    font-size: 14px;
}

/* 追加ボタンの配置 - 動的に位置計算される */
.add-btn {
    position: absolute;
    background: #fff;
    color: rgb(255, 255, 255);
    border: 1px solid #ccc;
    border-radius: 1000px;
    padding: 1px 2px;
    font-size: 10px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    z-index: 10;
}

.add-btn:hover {
    background: #e0e0e0;
    color: #000;
}

/* 空のセル（数量、単価、金額欄） */
.section-empty-cell {
    border: none !important;
    border-bottom: 1px solid #000 !important;  /* 下線のみ */
    padding: 12px !important;
    background: #fff;        /* 白背景 */
}

/* 右寄せ用クラス */
.right {
    text-align: right;
}

/* ==============================================
   合計・税額エリア（画像デザイン完全再現）
   ============================================== */

/* 合計セクション全体 */
.totals {
    margin-top: 24px;
    margin-left: 50%;
    width: 50%;
}

/* 各合計行 */
.totals .row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #000;
    padding: 8px 0;
}

/* 合計行のラベル部分 */
.totals .total-label {
    flex: 1;
    text-align: left;
    padding-left: 12px;
    font-weight: normal;
}

/* 合計行の金額部分（テーブルの金額列と幅を揃える） */
.totals .total-amount {
    width: 120px;            /* テーブルの金額列と同じ幅 */
    text-align: right;
    padding-right: 12px;
    font-weight: normal;
}

/* 最終合計行（合計）のスタイル */
.totals .row.final-total {
    background: #000;        /* 黒背景 */
    color: #fff;             /* 白文字 */
}

.totals .row.final-total .total-label {
    font-weight: 700;
}

.totals .row.final-total .total-amount {
    font-weight: 700;
    font-size: 15px;         /* 少し大きめの文字 */
}

/* ==============================================
   振込情報エリア
   ============================================== */

/* 振込情報セクション */
.bank {
    margin-top: 24px;        /* 上マージン */
    border-top: 1px solid #000;
    padding-top: 12px;       /* 上パディング */
    font-size: 13px;         /* 文字サイズ */
    line-height: 1.6;        /* 行間 */
}

.bank > div {
    display: grid;
    grid-template-columns: 80px 1fr;
    margin-bottom: 4px;
}

.bank > div b {
    display: inline-block;
    min-width: 80px;         /* ラベル部分の最小幅 */
    margin-right: 12px;      /* ラベルと値の間隔 */
}

.bank > div:not(.notes) {
    padding-bottom: 2px;
}

.bank > div.transfer {
    -left: 80%;
}

.bank .notes {
    margin-top: 8px;
    border-bottom: none;
    padding-bottom: 0;
}

/* 備考欄 */
.notes {
    margin-top: 8px;
    font-size: 12px;         /* 備考文字サイズ */
    color: #444;             /* 備考文字色 */
    line-height: 1.5;
}

/* ==============================================
   フッター
   ============================================== */

/* ページ下部のフッターテキスト */
.footer {
    position: absolute;
    bottom: 10mm;            /* 下からの距離 */
    left: 16mm;              /* 左からの距離 */
    right: 16mm;             /* 右からの距離 */
    font-size: 10px;         /* フッター文字サイズ */
    color: #666;             /* フッター文字色 */
    text-align: center;
}
/* PDF生成時に非表示にする要素 */
.pdf-generating .add-btn,
.pdf-generating button,
.pdf-generating .btn {
  display: none !important;
  visibility: hidden !important;
}

@media print{
  body{background:#fff}
  .wrap{display:block;padding:0}
  .control-bar{display:none !important}
  .preview-wrap{position:static}
  .preview{border:none}
  .hide-print{display:none !important}
  .add-btn{display:none !important}
  button{display:none !important}
  .btn{display:none !important}
  #postal_input_modal{display:none !important}
  input[type="text"]{border:none !important; background:transparent !important}
}
.tag{font-size:11px;padding:2px 8px;border-radius:999px;border:1px solid var(--border);display:inline-block}
.chip{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-size:12px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.hr{height:1px;background:var(--border);margin:12px 0}

/* ==============================================
   プレビュー直接編集機能
   ============================================== */

/* 編集可能な要素のスタイル */
.editable {
    transition: background-color 0.2s ease;
    border-radius: 2px;
    padding: 1px 2px;
    min-height: 1.2em;
    display: inline-block;
    min-width: 20px;
}

.editable:hover {
    background-color: #f0f8ff;
    outline: 1px dashed #ccc;
}

.editable:focus {
    background-color: #fff;
    outline: 2px solid #4a90e2;
    box-shadow: 0 0 3px rgba(74, 144, 226, 0.3);
}

/* 読み取り専用フィールドのスタイル */
.readonly-field {
    padding: 1px 2px;
    border-radius: 2px;
}

/* ==============================================
   セクションヘッダーと追加ボタン
   ============================================== */

/* この部分は上で新しく定義済み */

/* 追加ボタン */
.add-btn {
    background: rgba(74, 144, 226, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    color: #000;
    transition: all 0.2s ease;
    margin-left: 10px;
}

.add-btn:hover {
    background: rgba(74, 144, 226, 0.2);
    border-color:rgb(0, 0, 0);
    transform: scale(1.1);
}

/* 印刷時に非表示 */
.hide-print {
    display: block;
}

/* ==============================================
   宛名エリアのスタイル
   ============================================== */

/* 宛名行全体のスタイルは上記で定義済み */

/* 敬称クリック可能エリア */
#p_honorific_clickable {
    cursor: pointer;
    user-select: none;
    background-color: transparent;
    padding: 2px 4px;
    border-radius: 3px;
    transition: background-color 0.2s ease;
    margin-left: auto; /* 右端に配置 */
}

#p_honorific_clickable:hover {
    background-color: #f0f8ff;
}

/* 郵便番号モーダル */
#postal_input_modal {
    display: none;
    position: absolute;
    z-index: 1000;
    background: white;
    border: 2px solid #4a90e2;
    border-radius: 8px;
    padding: 16px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.postal-modal-title {
    margin-bottom: 12px;
    font-weight: 600;
}

.postal-input-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
}

.postal-code-input {
    text-align: center;
    font-size: 13px;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 4px;
}

.postal-code-input:focus {
    outline: 2px solid #4a90e2;
    border-color: #4a90e2;
}

#postal_code_1 {
    width: 40px;
}

#postal_code_2 {
    width: 50px;
}

.postal-button-row {
    display: flex;
    gap: 8px;
}

.postal-button {
    padding: 6px 12px;
    font-size: 12px;
    border-radius: 4px;
    cursor: pointer;
    border: 1px solid;
}

#address_lookup_btn {
    border-color: #4a90e2;
    background: #4a90e2;
    color: white;
}

#postal_modal_close {
    border-color: #ddd;
    background: #f5f5f5;
    color: #333;
}


/* テーブル内の編集可能セル */
.editable-cell {
    border: none;
    background: transparent;
    width: 100%;
    padding: 4px;
    font-size: inherit;
    font-family: inherit;
    text-align: inherit;
}

.editable-cell:focus {
    outline: 2px solid #4a90e2;
    background: #fff;
}
